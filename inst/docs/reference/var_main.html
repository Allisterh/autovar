<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Determine possibly optimal models for Vector Autoregression — var_main • autovar</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Determine possibly optimal models for Vector Autoregression — var_main" />

<meta property="og:description" content="This function generates and tests possible VAR models for the specified variables. The only required arguments are av_state and vars." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autovar</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Determine possibly optimal models for Vector Autoregression</h1>
    
    <div class="hidden name"><code>var_main.Rd</code></div>
    </div>

    
    <p>This function generates and tests possible VAR models for the specified variables. The only required arguments are <code>av_state</code> and <code>vars</code>.</p>
    

    <pre class="usage"><span class='fu'>var_main</span>(<span class='no'>av_state</span>, <span class='no'>vars</span>, <span class='kw'>lag_max</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>significance</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>exogenous_max_iterations</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>log_level</span> <span class='kw'>=</span> <span class='no'>av_state</span>$<span class='no'>log_level</span>, <span class='kw'>small</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>include_model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>exogenous_variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>use_sktest</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>restrictions.verify_validity_in_every_step</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>restrictions.extensive_search</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>criterion</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"AIC"</span>, <span class='st'>"BIC"</span>),
  <span class='kw'>use_varsoc</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>use_pperron</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>include_squared_trend</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>normalize_data</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>include_lag_zero</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>split_up_outliers</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>format_output_like_stata</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>exclude_almost</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>simple_models</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>numcores</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>av_state</th>
      <td><p>an object of class <code>av_state</code></p></td>
    </tr>
    <tr>
      <th>vars</th>
      <td><p>the vector of variables on which to perform vector autoregression. These should be the names of existing columns in the data sets of <code>av_state</code>.</p></td>
    </tr>
    <tr>
      <th>lag_max</th>
      <td><p>limits the highest possible number of lags that will be used in a model. This number sets the maximum limit in the search for optimal lags.</p></td>
    </tr>
    <tr>
      <th>significance</th>
      <td><p>the maximum P-value for which results are seen as significant. This argument is used only in the residual tests.</p></td>
    </tr>
    <tr>
      <th>exogenous_max_iterations</th>
      <td><p>determines how many times we should try to exclude additional outliers for a variable. This argument should be a number between 1 and 3:</p><ul>
<li><p><code>1</code> - When residual tests fail, having <code>exogenous_max_iterations = 1</code> will only try with removing 3.5x std. outliers for the residuals of variables using exogenous dummy variables.</p></li>
<li><p><code>2</code> - When <code>exogenous_max_iterations = 2</code>, the program will also try with removing 3x std. outliers if residual tests still fail.</p></li>
<li><p><code>3</code> - When <code>exogenous_max_iterations = 3</code>, the program will also try with removing 2.5x std. outliers (not only from the residuals but also from the squares of the residuals) if residual tests still fail.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>specifies which data subset the VAR analysis should run on. The VAR analysis only runs on one data subset at a time. If not specified, the first subset is used (corresponding to <code>av_state$data[[1]]</code>).</p></td>
    </tr>
    <tr>
      <th>log_level</th>
      <td><p>sets the minimum level of output that should be shown. It should be a number between 0 and 3. A lower level means more verbosity. <code>0</code> = debug, <code>1</code> = test detail, <code>2</code> = test outcomes, <code>3</code> = normal. The default is set to the value of <code>av_state$log_level</code> or if that doesn't exist, to <code>0</code>. If this argument was specified, the original value of <code>av_state$log_level</code> is be restored at the end of <code>var_main</code>.</p></td>
    </tr>
    <tr>
      <th>small</th>
      <td><p>corresponds to the <code>small</code> argument of Stata's <code>var</code> function, and defaults to <code>FALSE</code>. This argument affects the outcome of the Granger causality test. When <code>small = TRUE</code>, the Granger causality test uses the F-distribution to gauge the statistic. When <code>small = FALSE</code>, the Granger causality test uses the Chi-squared distribution to gauge the statistic.</p></td>
    </tr>
    <tr>
      <th>include_model</th>
      <td><p>can be used to forcibly include a model in the evaluation. Included models have to be lists, and can specify the parameters <code>lag</code>, <code>exogenous_variables</code>, and <code>apply_log_transform</code>. For example: <code>
av_state &lt;- var_main(av_state,c('Activity_hours','Depression'),
                     log_level=3,
                     small=TRUE,
                     include_model=list(lag=3,
                        exogenous_variables=data.frame(variable="Depression",
                        iteration=1,stringsAsFactors=FALSE),
                        apply_log_transform=TRUE))
var_info(av_state$rejected_models[[1]]$varest)
</code>
The above example includes a model with <code>lag=3</code> (so lags 1, 2, and 3 are included), the model is ran on the log-transformed variables, and includes an exogenous dummy variable that has a 1 where values of <code>log(Depression)</code> are more than 3.5xstd away from the mean (because <code>iteration=1</code>, see the description of the <code>exogenous_max_iterations</code> parameter above for the meaning of the iterations) and 0 everywhere else. The included model is added at the start of the list, so it can be retrieved (assuming a valid <code>lag</code> was specified) with either <code>av_state$accepted_models[[1]]</code> if the model was valid or <code>av_state$rejected_models[[1]]</code> if it was invalid. In the above example, some info about the included model is printed (assuming it was invalid).</p></td>
    </tr>
    <tr>
      <th>exogenous_variables</th>
      <td><p>should be a vector of variable names that already exist in the given data set, that will be supplied to every VAR model as exogenous variables.</p></td>
    </tr>
    <tr>
      <th>use_sktest</th>
      <td><p>affects which test is used for Skewness and Kurtosis testing of the residuals. When <code>use_sktest = TRUE</code> (the default), STATA's <code>sktest</code> is used. When <code>use_sktest = FALSE</code>, STATA's <code>varnorm</code> (i.e., the Jarque-Bera test) is used.</p></td>
    </tr>
    <tr>
      <th>restrictions.verify_validity_in_every_step</th>
      <td><p>is an argument that affects how constraints are found for valid models. When this argument is <code>TRUE</code> (the default), all intermediate models in the iterative constraint-finding method have to be valid. This ensures that we always find a valid constrained model for every valid model. If this argument is <code>FALSE</code>, then only after setting all constraints do we check if the resulting model is valid. If this is not the case, we fail to find a constrained model.</p></td>
    </tr>
    <tr>
      <th>restrictions.extensive_search</th>
      <td><p>is an argument that affects how constraints are found for valid models. When this argument is <code>TRUE</code> (the default), when the term with the highest p-value does not provide a model with a lower BIC score, we attempt to constrain the term with the second highest p-value, and so on. When this argument is <code>FALSE</code>, we only check the term with the highest p-value. If restricting this term does not give an improvement in BIC score, we stop restricting the model entirely.</p></td>
    </tr>
    <tr>
      <th>criterion</th>
      <td><p>is the information criterion used to sort the models. Valid options are  <code>'AIC'</code> (the default) or <code>'BIC'</code>.</p></td>
    </tr>
    <tr>
      <th>use_varsoc</th>
      <td><p>determines whether VAR lag order selection criteria should be employed to restrict the search space for VAR models. When <code>use_varsoc</code> is <code>FALSE</code>, all lags from 1 to <code>lag_max</code> are searched.</p></td>
    </tr>
    <tr>
      <th>use_pperron</th>
      <td><p>determines whether the Phillips-Perron test should be used to determine whether trend variables should be included in the models. When <code>use_pperron</code> is <code>FALSE</code>, all models will be evaluated both with and without the trend variable. The trend variable is specified using the <code><a href='order_by.html'>order_by</a></code> function.</p></td>
    </tr>
    <tr>
      <th>include_squared_trend</th>
      <td><p>determines whether the square of the trend is included if the trend is included for a model. The trend variable is specified using the <code><a href='order_by.html'>order_by</a></code> function.</p></td>
    </tr>
    <tr>
      <th>normalize_data</th>
      <td><p>determines whether the endogenous variables should be normalized.</p></td>
    </tr>
    <tr>
      <th>include_lag_zero</th>
      <td><p>determines whether models at lag order 0 are should be considered. These are models at lag 1 with constrained lag-1 parameters in all equations.</p></td>
    </tr>
    <tr>
      <th>split_up_outliers</th>
      <td><p>determines whether each outlier should have its own exogenous variable. Defaults to TRUE. This will make a difference only when there is a variable with multiple outliers.</p></td>
    </tr>
    <tr>
      <th>format_output_like_stata</th>
      <td><p>when <code>TRUE</code>, all constraints and exogenous variables are always shown (i.e., it will now show exogenous variables that were included but constrained in all equations), and the constraints are formatted like in Stata.</p></td>
    </tr>
    <tr>
      <th>exclude_almost</th>
      <td><p>when <code>TRUE</code>, only Granger causalities with p-value &lt;= 0.05 are included in the results. When <code>FALSE</code>, p-values between 0.05 and 0.10 are also included in results as "almost Granger causalities" that have half the weight of actual Granger causalities in the Granger causality summary graph.</p></td>
    </tr>
    <tr>
      <th>simple_models</th>
      <td><p>when <code>TRUE</code>, four changes are made in the way Autovar works.</p><ol>
<li><p>Sets autovar to search only for lag 1 and lag 2 models. Additionally, the lag 2 models are restricted in the sense that only the autoregressive lag 2 is used, i.e., the cross-lagged parameters for lag 2 are constrained.</p></li>
<li><p>The normality assumption (sktest) no longer tests for kurtosis (only for skewness).</p></li>
<li><p><code>exogenous_max_iterations</code> is set to 1, meaning we only search one iteration deep for masking outliers, and in this iteration, points that are 2.5xstd away in the residuals or in the squared residuals are masked as outliers.</p></li>
<li><p>Autovar no longer considers constrained versions of the valid models.</p></li>
</ol></td>
    </tr>
    <tr>
      <th>numcores</th>
      <td><p>is the number of cores to use in parallel for evaluation the model. When this variable is <code>1</code>, no parallel processing is used and all processing is done serially. This variable has to be an integer between 1 and 16. The default value is the detected number of cores on the system (using <code>detectCores()</code>). If the <code>log_level</code> is less than 3, the value for <code>numcores</code> is forced to 1 because output doesn't show up otherwise.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns the modified <code>av_state</code> object. The lists of accepted and rejected models can be retrieved through <code>av_state$accepted_models</code> and <code>av_state$rejected_models</code>. To print these, use <code><a href='print_accepted_models.html'>print_accepted_models(av_state)</a></code> and <code><a href='print_rejected_models.html'>print_rejected_models(av_state)</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>av_state</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='load_file.html'>load_file</a></span>(<span class='st'>"../data/input/Activity and depression pp5 Angela.dta"</span>,<span class='kw'>log_level</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>av_state</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='group_by.html'>group_by</a></span>(<span class='no'>av_state</span>,<span class='st'>'id'</span>)
<span class='no'>av_state</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='order_by.html'>order_by</a></span>(<span class='no'>av_state</span>,<span class='st'>'Day'</span>)
<span class='no'>av_state</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='add_derived_column.html'>add_derived_column</a></span>(<span class='no'>av_state</span>,<span class='st'>'Activity_hours'</span>,<span class='st'>'Activity'</span>,
                               <span class='kw'>operation</span><span class='kw'>=</span><span class='st'>'MINUTES_TO_HOURS'</span>)
<span class='no'>av_state</span> <span class='kw'>&lt;-</span> <span class='fu'>var_main</span>(<span class='no'>av_state</span>,<span class='fu'>c</span>(<span class='st'>'Activity_hours'</span>,<span class='st'>'Depression'</span>),<span class='kw'>log_level</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ando Emerencia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

